<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Life Simulator: Ultimate Edition</title>
  <style>
    /* Basic reset & styling */
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f2f2f2;
      color: #333;
      overflow: hidden;
    }
    #game-container {
      display: flex;
      height: 100vh;
    }
    /* Left panel for controls and status */
    #left-panel {
      width: 380px;
      background: #fff;
      border-right: 2px solid #ccc;
      padding: 15px;
      overflow-y: auto;
    }
    #header {
      font-size: 1.8em;
      font-weight: bold;
      margin-bottom: 10px;
      text-align: center;
    }
    #status-panel p {
      margin: 4px 0;
    }
    #game-log {
      height: 40vh;
      overflow-y: auto;
      border: 1px solid #ddd;
      padding: 10px;
      background: #e9ecef;
      margin-bottom: 15px;
      font-size: 0.95em;
    }
    #control-panel {
      text-align: center;
      margin-bottom: 10px;
    }
    button {
      margin: 5px;
      padding: 10px 15px;
      font-size: 1em;
      cursor: pointer;
    }
    /* Right panel for canvas timeline */
    #right-panel {
      flex: 1;
      position: relative;
      background: #dee2e6;
    }
    #life-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #fff;
    }
    /* Hidden extra status (for responsive design if needed) */
    #left-panel-extra { display: none; }
  </style>
</head>
<body>
  <div id="game-container">
    <!-- Left Panel: Status, Log & Controls -->
    <div id="left-panel">
      <div id="header">Life Simulator: Ultimate Edition</div>
      <div id="status-panel">
        <p><strong>Name:</strong> <span id="playerName">-</span></p>
        <p><strong>Age:</strong> <span id="playerAge">0</span></p>
        <p><strong>Health:</strong> <span id="playerHealth">100</span></p>
        <p><strong>Happiness:</strong> <span id="playerHappiness">50</span></p>
        <p><strong>Wealth:</strong> $<span id="playerWealth">1000</span></p>
        <p><strong>Education:</strong> <span id="playerEducation">None</span></p>
        <p><strong>Career:</strong> <span id="playerCareer">None</span></p>
        <p><strong>Intelligence:</strong> <span id="playerIntelligence">0</span></p>
        <p><strong>Creativity:</strong> <span id="playerCreativity">0</span></p>
        <p><strong>Social:</strong> <span id="playerSocial">0</span></p>
        <p><strong>Married:</strong> <span id="playerMarried">No</span></p>
        <p><strong>Children:</strong> <span id="playerChildren">0</span></p>
      </div>
      <div id="game-log">
        <p>Welcome to your life! Click "New Game" to begin your journey through countless decisions!</p>
      </div>
      <div id="control-panel">
        <button id="newGameBtn">New Game</button>
        <button id="nextYearBtn" style="display:none;">Next Year</button>
      </div>
    </div>
    <!-- Right Panel: Canvas Timeline -->
    <div id="right-panel">
      <canvas id="life-canvas"></canvas>
    </div>
  </div>

  <script>
    /*******************
     * Player & Globals
     *******************/
    var player = {
      name: "",
      age: 0,
      health: 100,
      happiness: 50,
      wealth: 1000,
      education: "None",
      career: "None",
      intelligence: 0,
      creativity: 0,
      social: 0,
      married: false,
      children: 0,
      history: [] // For timeline events
    };
    var pendingDecision = false;

    /*******************
     * Event Pools
     *******************/
    // Each event is an object with id, description, and a set of options.
    var educationEvents = [];
    var careerEvents = [];
    var relationshipEvents = [];
    var healthEvents = [];
    var travelEvents = [];
    var randomEvents = [];

    // Utility: choose a random element from an array.
    function chooseRandom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    // Populate event arrays with many decisions.
    function initEvents() {
      // Education Events (50 events)
      for (var i = 1; i <= 50; i++) {
        educationEvents.push({
          id: "edu" + i,
          description: "Education Event " + i + ": You face a learning challenge. Do you study hard or relax?",
          options: [
            { text: "Study Hard", effect: function() { player.intelligence += 1; player.happiness -= 2; addLog("You studied hard, boosting your intelligence."); } },
            { text: "Relax", effect: function() { player.happiness += 2; player.intelligence -= 1; addLog("You relaxed, but your grades slipped a bit."); } }
          ]
        });
      }
      // Career Events (50 events)
      for (var i = 1; i <= 50; i++) {
        careerEvents.push({
          id: "car" + i,
          description: "Career Event " + i + ": A big project comes up. Risk it for a reward or stay cautious?",
          options: [
            { text: "Risk It", effect: function() { player.wealth += 2000; player.happiness += 3; addLog("Taking risks paid off at work!"); } },
            { text: "Stay Cautious", effect: function() { player.wealth += 500; addLog("You maintained a steady pace, earning a modest bonus."); } }
          ]
        });
      }
      // Relationship Events (50 events)
      for (var i = 1; i <= 50; i++) {
        relationshipEvents.push({
          id: "rel" + i,
          description: "Relationship Event " + i + ": At a social event, do you mingle widely or stick to a close group?",
          options: [
            { text: "Mingle", effect: function() { player.social += 1; player.happiness += 5; addLog("You mingled and made valuable connections."); } },
            { text: "Stick to Close Group", effect: function() { player.happiness -= 2; addLog("You stayed with familiar faces, missing some opportunities."); } }
          ]
        });
      }
      // Health Events (30 events)
      for (var i = 1; i <= 30; i++) {
        healthEvents.push({
          id: "hea" + i,
          description: "Health Event " + i + ": You experience a bout of illness. Do you rest or push through?",
          options: [
            { text: "Rest", effect: function() { player.health += 10; player.happiness -= 2; addLog("Resting helped you recover."); } },
            { text: "Push Through", effect: function() { player.health -= 10; player.happiness += 1; addLog("You pushed through, but your body paid the price."); } }
          ]
        });
      }
      // Travel Events (30 events)
      for (var i = 1; i <= 30; i++) {
        travelEvents.push({
          id: "tra" + i,
          description: "Travel Event " + i + ": A chance to visit a new country appears. Do you seize it?",
          options: [
            { text: "Travel", effect: function() { player.happiness += 15; player.wealth -= 3000; addLog("You traveled and broadened your horizons."); } },
            { text: "Decline", effect: function() { player.happiness -= 2; addLog("You missed the travel opportunity."); } }
          ]
        });
      }
      // Random Events (100 events)
      for (var i = 1; i <= 100; i++) {
        randomEvents.push({
          id: "ran" + i,
          description: "Random Event " + i + ": An unforeseen incident arises. What is your move?",
          options: [
            { text: "Option A", effect: function() { player.wealth += 1000; addLog("Option A improved your finances."); } },
            { text: "Option B", effect: function() { player.health -= 5; addLog("Option B took a toll on your health."); } },
            { text: "Option C", effect: function() { player.happiness += 3; addLog("Option C lifted your spirits."); } }
          ]
        });
      }
    }

    /*******************
     * UI Helper Functions
     *******************/
    // Append a message to the game log.
    function addLog(message) {
      var log = document.getElementById("game-log");
      var p = document.createElement("p");
      p.innerHTML = message;
      log.appendChild(p);
      log.scrollTop = log.scrollHeight;
    }

    // Update the status panel with the current player stats.
    function updateStatus() {
      document.getElementById("playerName").textContent = player.name;
      document.getElementById("playerAge").textContent = player.age;
      document.getElementById("playerHealth").textContent = player.health;
      document.getElementById("playerHappiness").textContent = player.happiness;
      document.getElementById("playerWealth").textContent = player.wealth;
      document.getElementById("playerEducation").textContent = player.education;
      document.getElementById("playerCareer").textContent = player.career;
      document.getElementById("playerIntelligence").textContent = player.intelligence;
      document.getElementById("playerCreativity").textContent = player.creativity;
      document.getElementById("playerSocial").textContent = player.social;
      document.getElementById("playerMarried").textContent = player.married ? "Yes" : "No";
      document.getElementById("playerChildren").textContent = player.children;
    }

    // Show a decision event with its options.
    function showDecision(eventObj, callback) {
      var controlPanel = document.getElementById("control-panel");
      controlPanel.innerHTML = "";
      addLog("<strong>" + eventObj.description + "</strong>");
      eventObj.options.forEach(function(option) {
        var btn = document.createElement("button");
        btn.textContent = option.text;
        btn.addEventListener("click", function() {
          option.effect();
          callback();
          controlPanel.innerHTML = "";
          controlPanel.appendChild(document.getElementById("nextYearBtn"));
          updateStatus();
        });
        controlPanel.appendChild(btn);
      });
    }

    /*******************
     * Simulation Engine
     *******************/
    function simulateYear() {
      if (pendingDecision) return; // wait if a decision is active
      player.age++;
      addLog("<hr><strong>Year " + player.age + ":</strong> A new chapter unfolds.");
      player.history.push({ year: player.age, note: "Year " + player.age });
      
      // Milestone decisions
      if (player.age === 18) {
        var decision18 = {
          description: "At 18, decide your future: Enroll in college, start working, or take a gap year to travel.",
          options: [
            { text: "College", effect: function() { player.education = "College"; player.wealth -= 10000; player.intelligence += 2; addLog("You chose college, investing in your future."); } },
            { text: "Work", effect: function() { player.career = "Junior Employee"; player.wealth += 5000; player.social += 1; addLog("You jumped into the workforce."); } },
            { text: "Gap Year", effect: function() { player.education = "Self-Taught"; player.wealth -= 5000; player.happiness += 10; addLog("You took a gap year to travel and learn about the world."); } }
          ]
        };
        pendingDecision = true;
        showDecision(decision18, function() { pendingDecision = false; });
        return;
      }
      if (player.age === 25 && !player.married) {
        var decision25 = {
          description: "At 25, a significant other enters your life. Do you get married?",
          options: [
            { text: "Marry", effect: function() { player.married = true; player.happiness += 20; addLog("You tied the knot!"); } },
            { text: "Stay Single", effect: function() { player.happiness += 5; addLog("You remain single and focus on yourself."); } }
          ]
        };
        pendingDecision = true;
        showDecision(decision25, function() { pendingDecision = false; });
        return;
      }
      if (player.age === 30 && player.married && player.children < 3) {
        var decision30 = {
          description: "At 30, your partner suggests starting a family. Do you have a child?",
          options: [
            { text: "Have Child", effect: function() { player.children++; player.happiness += 15; player.wealth -= 5000; addLog("A new life begins in your family."); } },
            { text: "Not Yet", effect: function() { player.happiness += 2; addLog("You decide to wait a bit longer."); } }
          ]
        };
        pendingDecision = true;
        showDecision(decision30, function() { pendingDecision = false; });
        return;
      }
      if (player.age === 65) {
        var decision65 = {
          description: "At 65, retirement beckons. Do you retire or continue working?",
          options: [
            { text: "Retire", effect: function() { player.happiness += 20; player.wealth += 5000; addLog("You retire and enjoy your golden years."); } },
            { text: "Keep Working", effect: function() { player.happiness -= 5; addLog("You choose to work a few more years."); } }
          ]
        };
        pendingDecision = true;
        showDecision(decision65, function() { pendingDecision = false; });
        return;
      }
      
      // Determine event pool based on age/stage
      var eventPool = [];
      if (player.age < 18) {
        eventPool = educationEvents;
      } else if (player.age < 25) {
        eventPool = educationEvents.concat(randomEvents);
      } else if (player.age < 35) {
        eventPool = careerEvents.concat(relationshipEvents, randomEvents);
      } else if (player.age < 50) {
        eventPool = careerEvents.concat(healthEvents, travelEvents, randomEvents);
      } else if (player.age < 65) {
        eventPool = healthEvents.concat(relationshipEvents, randomEvents);
      } else {
        eventPool = randomEvents;
      }
      // Pick a random event from the pool and show decision
      var eventObj = chooseRandom(eventPool);
      pendingDecision = true;
      showDecision(eventObj, function() { pendingDecision = false; });
      updateStatus();
      drawTimeline();
    }

    /*******************
     * Canvas Timeline
     *******************/
    var canvas = document.getElementById("life-canvas");
    var ctx = canvas.getContext("2d");
    function resizeCanvas() {
      canvas.width = canvas.parentElement.clientWidth;
      canvas.height = canvas.parentElement.clientHeight;
      drawTimeline();
    }
    window.addEventListener("resize", resizeCanvas);
    function drawTimeline() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      var margin = 40;
      var lineY = canvas.height - margin;
      ctx.beginPath();
      ctx.moveTo(margin, lineY);
      ctx.lineTo(canvas.width - margin, lineY);
      ctx.strokeStyle = "#444";
      ctx.lineWidth = 2;
      ctx.stroke();
      // Mark each year as a dot on the timeline.
      for (var i = 0; i < player.history.length; i++) {
        var x = margin + (i / (player.age + 1)) * (canvas.width - 2 * margin);
        ctx.beginPath();
        ctx.arc(x, lineY, 4, 0, Math.PI * 2);
        ctx.fillStyle = "#007bff";
        ctx.fill();
      }
    }

    /*******************
     * New Game & Event Listeners
     *******************/
    function newGame() {
      player = {
        name: prompt("What is your name?") || "Anonymous",
        age: 0,
        health: 100,
        happiness: 50,
        wealth: 1000,
        education: "None",
        career: "None",
        intelligence: Math.floor(Math.random() * 10) + 1,
        creativity: Math.floor(Math.random() * 10) + 1,
        social: Math.floor(Math.random() * 10) + 1,
        married: false,
        children: 0,
        history: []
      };
      document.getElementById("game-log").innerHTML = "";
      addLog("Welcome, " + player.name + "! Your life begins now. Countless decisions await you.");
      pendingDecision = false;
      updateStatus();
      resizeCanvas();
      document.getElementById("newGameBtn").style.display = "none";
      document.getElementById("nextYearBtn").style.display = "inline-block";
    }

    // Setup event listeners for the control buttons.
    document.getElementById("newGameBtn").addEventListener("click", function() { initEvents(); newGame(); });
    document.getElementById("nextYearBtn").addEventListener("click", simulateYear);
    document.addEventListener("keydown", function(e) {
      if (e.key === "Enter" && !pendingDecision) simulateYear();
    });
    // Initialize canvas size
    resizeCanvas();
  </script>
</body>
</html>
